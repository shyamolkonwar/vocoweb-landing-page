-- Create the table for storing vulnerability reports
create table public.vulnerability_reports (
  id uuid not null default gen_random_uuid (),
  created_at timestamp with time zone not null default now(),
  name text not null,
  email text not null,
  severity text not null default 'low'::text,
  description text not null,
  steps_to_reproduce text,
  constraint vulnerability_reports_pkey primary key (id)
) tablespace pg_default;

-- Enable Row Level Security (RLS)
alter table public.vulnerability_reports enable row level security;

-- Create a policy that allows the service role (API) to insert data
create policy "Enable insert for service role only"
  on public.vulnerability_reports
  for insert
  to service_role
  with check (true);

-- Create a policy that allows the service role (API) to view data
create policy "Enable select for service role only"
  on public.vulnerability_reports
  for select
  to service_role
  using (true);
